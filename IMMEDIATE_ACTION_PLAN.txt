â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                         IMMEDIATE ACTION PLAN
                    Deploy Kassangas WhatsApp Bot - Week 1
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“… TODAY - DO NOW (No credentials needed)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… TASK 1: Run Database Migration #1 (5 min)
   File:    migrations/2025-02-06_add_bot_tenants_schema.sql
   Action:  Copy entire file â†’ Supabase SQL Editor â†’ Click RUN
   Verify:  SELECT table_name FROM information_schema.tables 
            WHERE table_schema = 'alphadome' AND table_name LIKE 'bot_%'
   Result:  4 tables created (bot_tenants, bot_templates, bot_training_data, bot_control_settings)


âœ… TASK 2: Add Tenant Middleware to server.js (30 min)
   File:    TENANT_MIDDLEWARE_CODE.js (reference)
   Target:  server.js (line ~50, after getPaymentAmount function)
   Add:     6 middleware functions:
            - loadTenantContext()
            - loadTenantTemplates()
            - loadTenantTrainingData()
            - getSystemPrompt()
            - getDecryptedCredentials()
   Verify:  npm start (should start without errors)


âœ… TASK 3: Update generateReply() Function (30 min)
   File:    TENANT_MIDDLEWARE_CODE.js (reference)
   Target:  server.js (replace existing generateReply function)
   Change:  Accept tenant + templates + trainingData parameters
   New:     Match user questions against FAQ before calling OpenAI
   Impact:  Faster responses, better customization, tenant-aware


âœ… TASK 4: Update POST /webhook Handler (45 min)
   File:    TENANT_MIDDLEWARE_CODE.js (reference)
   Target:  server.js (update POST /webhook handler)
   Add:     loadTenantContext middleware to handler
   Change:  Pass tenant + templates + trainingData to generateReply()
   Impact:  Every message now routed through tenant context
   Keep:    All existing M-Pesa/JOIN ALPHADOME logic unchanged


âœ… TASK 5: Create and Run Test Script (10 min)
   File:    test_tenant_setup.js (already exists)
   Action:  npm install chalk (if needed)
            node test_tenant_setup.js
   Verify:  6 tests pass
            Expected: "No tenants found yet (expected - waiting for credentials)"
   Result:  Database setup confirmed


âœ… TASK 6: Commit Code Changes (5 min)
   Action:  git add server.js test_tenant_setup.js
            git commit -m "feat: add multi-tenant support (Week 1)"
            git push origin main (or your branch)
   Result:  Changes saved


âœ… TASK 7: Send Credential Request to Gideon (5 min)
   File:    META_CREDENTIALS_CHECKLIST.md (copy message section)
   Action:  Send via WhatsApp/email to Gideon
   Include: 3 Meta credentials needed:
            1. WhatsApp Business Phone Number ID (numeric)
            2. WhatsApp Business Account ID (optional)
            3. WhatsApp Access Token (long string, KEEP SECRET)
   Result:  Waiting for response from Gideon


ğŸ“Š TODAY'S SUMMARY
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Time Required:        2-2.5 hours
Blocking Issues:      NONE
Code Changes:         YES (significant but backward compatible)
Database Changes:     YES (4 new tables, no deletions)
Credential Needed:    NO - all tasks work without credentials
External Dependencies: NONE for this phase
Risk Level:           LOW (all changes additive, backward compatible)

Expected State After Today:
  âœ… Database ready for multi-tenants
  âœ… Server code tenant-aware
  âœ… Backward compatible (existing system still works)
  âœ… Credential request sent to Gideon
  âœ… System ready to receive Kassangas config


â³ WHEN GIDEON RESPONDS (1-2 days)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â³ TASK 8: Insert Kassangas Tenant (30 min)
   File:    migrations/2025-02-06_setup_kassangas_tenant.sql
   Action:  Update 3 placeholders with Gideon's credentials
            Copy â†’ Supabase SQL Editor â†’ Click RUN
   Update:  - whatsapp_phone_number_id: 'GIDEON_VALUE'
            - whatsapp_access_token: 'GIDEON_VALUE'  
            - client_email: 'gideon@example.com'
   Result:  Kassangas tenant created with templates + training data


â³ TASK 9: Verify Kassangas Setup (10 min)
   Action:  node test_tenant_setup.js
   Verify:  Output shows:
            âœ“ Kassangas tenant found
            âœ“ 3 templates loaded
            âœ“ 9 training entries loaded
   Result:  System ready for messages


â³ TASK 10: Send Test Message (5 min)
   Action:  From a WhatsApp account, send message to Kassangas number
   Verify:  Bot responds using Kassangas's prompt + OpenAI key
   Result:  End-to-end flow working


ğŸ“‹ CREDENTIAL CHECKLIST
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Required from Gideon (3 items):
â˜ WhatsApp Business Phone Number ID
  Where: Meta Business Manager â†’ WhatsApp â†’ Phone Numbers
  Format: Numeric (e.g., 868405499681303)
  Storage: bot_tenants.whatsapp_phone_number_id

â˜ WhatsApp Access Token âš ï¸ SECRET
  Where: Meta Business Manager â†’ Apps â†’ Your App â†’ Messenger â†’ Settings â†’ Token
  Format: Long string starting with 'EAA' (e.g., EAA...xyz)
  Storage: bot_tenants.whatsapp_access_token (encrypted in DB)

â˜ WhatsApp Business Account ID (optional but helpful)
  Where: Meta Business Manager â†’ Settings â†’ General â†’ Business ID
  Format: Numeric (e.g., 108459245087655)
  Storage: bot_tenants.whatsapp_business_account_id

Can Generate Locally (1 item):
âœ… Verify Token
  Action: Generate random string (e.g., using crypto.randomBytes(32).toString('hex'))
  Storage: bot_tenants.webhook_verify_token
  Purpose: Meta sends this back during webhook verification


ğŸ“‚ FILES REFERENCE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

JUST CREATED:
  â†’ WEEK1_IMPLEMENTATION_GUIDE.md (this detailed step-by-step guide)
  â†’ IMMEDIATE_ACTION_PLAN.txt (this summary)

ALREADY EXISTS:
  â†’ migrations/2025-02-06_add_bot_tenants_schema.sql
  â†’ migrations/2025-02-06_setup_kassangas_tenant.sql
  â†’ TENANT_MIDDLEWARE_CODE.js
  â†’ test_tenant_setup.js
  â†’ META_CREDENTIALS_CHECKLIST.md

DOCUMENTATION:
  â†’ 00_START_HERE.txt
  â†’ EXECUTIVE_SUMMARY.md
  â†’ DEPLOYMENT_PLAN.md
  â†’ DB_ALIGNMENT_REPORT.md
  â†’ MULTI_TENANT_README.md
  â†’ VISUAL_DIAGRAMS.md
  â†’ DOCUMENTATION_INDEX.md


ğŸš€ START HERE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Read:   WEEK1_IMPLEMENTATION_GUIDE.md (full step-by-step)
        â†’ Contains complete code for each step
        â†’ Copy-paste ready
        â†’ Verification commands included

Then Execute:
  1. STEP 1: Run database migration (5 min)
  2. STEP 2: Add middleware (30 min)
  3. STEP 3: Update generateReply() (30 min)
  4. STEP 4: Update webhook (45 min)
  5. STEP 5: Test script (10 min)
  6. STEP 6: Git commit (5 min)
  7. STEP 7: Credential request (5 min)

Questions? See DOCUMENTATION_INDEX.md


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Status: READY TO EXECUTE
Last Updated: Feb 6, 2026
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
